<?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:1.0:policy"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	PolicyId="testPolicy"
	RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:ordered-permit-overrides">

	<Description>testing</Description>
	<Target>
		<Subjects>
			<AnySubject />
		</Subjects>
		<Resources>
			<AnyResource />
		</Resources>
		<Actions>
			<AnyAction />
		</Actions>
	</Target>

	<Rule RuleId="AcceptTSF" Effect="Permit">
		<Description>
			Accept selected users to reach TSF
		</Description>
		<Target>
			<Subjects>
				<AnySubject />
			</Subjects>
			<Resources>
				<Resource>
					<ResourceMatch
						MatchId="urn:oasis:names:tc:xacml:1.0:function:anyURI-equal">
						<AttributeValue
							DataType="http://www.w3.org/2001/XMLSchema#anyURI">resource8</AttributeValue>
						<ResourceAttributeDesignator
							DataType="http://www.w3.org/2001/XMLSchema#anyURI"
							AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" />
					</ResourceMatch>
				</Resource>
			</Resources>

			<Actions>
				<AnyAction />
			</Actions>
		</Target>
		<Condition FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
				
				<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
						<SubjectAttributeDesignator
							DataType="http://www.w3.org/2001/XMLSchema#string"
							AttributeId="urn:attr:some:attribute:with:long:name:1" />
					</Apply>
					<AttributeValue
						DataType="http://www.w3.org/2001/XMLSchema#string">attr1Value</AttributeValue>
				</Apply>
				
				<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
						<SubjectAttributeDesignator
							DataType="http://www.w3.org/2001/XMLSchema#string"
							AttributeId="urn:attr:some:attribute:with:long:name:2" />
					</Apply>
					<AttributeValue
						DataType="http://www.w3.org/2001/XMLSchema#string">attr2Value</AttributeValue>
				</Apply>

				<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
						<SubjectAttributeDesignator
							DataType="http://www.w3.org/2001/XMLSchema#string"
							AttributeId="urn:attr:some:attribute:with:long:name:3" />
					</Apply>
					<AttributeValue
						DataType="http://www.w3.org/2001/XMLSchema#string">attr3Value</AttributeValue>
				</Apply>
 
				<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:any-of-all">
					<Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/>
					<SubjectAttributeDesignator
							DataType="http://www.w3.org/2001/XMLSchema#string"
							AttributeId="urn:attr:some:attribute:with:long:name:4" />
					<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-bag">
						<AttributeValue
							DataType="http://www.w3.org/2001/XMLSchema#string">attr4Value1</AttributeValue>
						<AttributeValue
							DataType="http://www.w3.org/2001/XMLSchema#string">attr4Value2</AttributeValue>
						<AttributeValue
							DataType="http://www.w3.org/2001/XMLSchema#string">attr4Value3</AttributeValue>
					</Apply>
				</Apply>
				
				<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:time-greater-than">
					<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:time-one-and-only">
						<EnvironmentAttributeDesignator
							DataType="http://www.w3.org/2001/XMLSchema#time"
							AttributeId="urn:oasis:names:tc:xacml:1.0:environment:current-time" />
					</Apply>
					<AttributeValue
						DataType="http://www.w3.org/2001/XMLSchema#time">2:12:34</AttributeValue>
				</Apply>
				
		</Condition>
	</Rule>

	<Rule RuleId="FinalRule" Effect="Deny" />
</Policy>